<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFIDC | Smart Store Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; background-color: #f4f7f6; }
        
        /* Watermark Background */
        .watermark {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            opacity: 0.05; z-index: -1; width: 300px; pointer-events: none;
        }

        /* Govt Form Style */
        .govt-table { width: 100%; border-collapse: collapse; border: 2px solid #000; background: white; }
        .govt-table th, .govt-table td { border: 1px solid #000; padding: 6px; text-align: center; font-size: 13px; }
        .govt-table th { background-color: #e5e7eb; }

        /* Blue Ledger Style */
        .ledger-blue-page { background-color: #f0f9ff; border: 2px solid #075985; padding: 15px; border-radius: 4px; }
        .ledger-blue-table { width: 100%; border-collapse: collapse; border: 1px solid #075985; }
        .ledger-blue-table th { background-color: #bae6fd; border: 1px solid #075985; padding: 8px; font-size: 12px; }
        .ledger-blue-table td { border: 1px solid #075985; padding: 8px; background: white; font-size: 12px; }

        .red-alert { color: white; background-color: #ef4444; font-weight: bold; padding: 2px 5px; border-radius: 3px; }
        .tab-active { border-bottom: 4px solid #064e3b; color: #064e3b; font-weight: bold; }
        
        @media print { .no-print { display: none; } .print-area { display: block !important; } }
    </style>
</head>
<body class="pb-20">

    <img src="https://upload.wikimedia.org/wikipedia/en/thumb/0/02/Bangladesh_Forest_Industries_Development_Corporation_logo.png/220px-Bangladesh_Forest_Industries_Development_Corporation_logo.png" class="watermark" alt="Logo">

    <header class="bg-[#064e3b] text-white p-4 text-center sticky top-0 z-50 no-print">
        <h1 class="text-xl font-bold">বাংলাদেশ বনশিল্প উন্নয়ন কর্পোরেশন</h1>
        <p class="text-sm font-semibold text-emerald-300">স্মার্ট স্টোর ম্যানেজমেন্ট</p>
    </header>

    <nav class="flex justify-around bg-white border-b border-gray-300 no-print shadow-sm">
        <button onclick="showSection('entry')" id="btn-entry" class="py-3 flex-1 tab-active">ডাটা এন্ট্রি</button>
        <button onclick="showSection('srn-view')" id="btn-srn-view" class="py-3 flex-1 text-gray-500">SRN বই</button>
        <button onclick="showSection('ledger-view')" id="btn-ledger-view" class="py-3 flex-1 text-gray-500">লেজার বুক</button>
        <button onclick="showSection('asset-view')" id="btn-asset-view" class="py-3 flex-1 text-gray-500">স্থায়ী সম্পদ</button>
    </nav>

    <main class="p-4 max-w-6xl mx-auto">

        <section id="entry-sec" class="tab-content no-print bg-white p-6 rounded-xl shadow-lg space-y-4">
            <h3 class="font-bold border-b pb-2 text-gray-700 uppercase">মালামাল গ্রহণ ফরম</h3>
            <input type="hidden" id="editId">
            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <input type="text" id="srnNo" placeholder="এস আর এন নং" class="p-3 border rounded-lg outline-none focus:ring-2 ring-emerald-500">
                <input type="date" id="srnDate" class="p-3 border rounded-lg outline-none">
                <input type="text" id="vendor" placeholder="কোথা হতে প্রাপ্ত" class="p-3 border rounded-lg outline-none">
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <select id="regType" onchange="loadList()" class="p-3 border rounded-lg font-bold bg-gray-50">
                    <option value="">রেজিস্টার নির্বাচন করুন</option>
                    <option value="1">১ নং রেজিস্টার</option>
                    <option value="2">২ নং রেজিস্টার</option>
                    <option value="3">৩ নং রেজিস্টার</option>
                </select>
                <select id="itemName" class="p-3 border rounded-lg outline-none bg-white"></select>
            </div>
            <textarea id="itemDesc" placeholder="মালামালের বিস্তারিত বিবরণ (যেমন: পিস্টন রিং, ৫/৮ সাইজ)" class="w-full p-3 border rounded-lg outline-none"></textarea>
            <div class="grid grid-cols-3 gap-3">
                <input type="text" id="unit" placeholder="একক" class="p-3 border rounded-lg">
                <input type="number" id="qty" placeholder="পরিমাণ" class="p-3 border rounded-lg">
                <input type="number" id="price" placeholder="দর" class="p-3 border rounded-lg">
            </div>
            <button id="saveBtn" onclick="saveData()" class="w-full bg-[#064e3b] text-white py-4 rounded-xl font-bold uppercase hover:bg-emerald-900 transition">সংরক্ষণ করুন</button>
        </section>

        <section id="srn-view-sec" class="tab-content hidden space-y-4">
            <div class="flex justify-between items-center no-print">
                <h3 class="font-bold">ভাণ্ডার গ্রহণ পত্র তালিকা</h3>
                <button onclick="window.print()" class="bg-blue-600 text-white px-4 py-2 rounded">প্রিন্ট</button>
            </div>
            <div id="srnContainer" class="space-y-10">
                </div>
        </section>

        <section id="ledger-view-sec" class="tab-content hidden space-y-6">
            <div class="bg-white p-4 no-print shadow rounded-lg mb-4">
                <input type="text" id="searchLedger" onkeyup="filterLedger()" placeholder="মালের নাম লিখে লেজার খুঁজুন..." class="w-full p-3 border rounded-lg outline-none border-blue-400">
            </div>
            <div id="ledgerContainer">
                </div>
        </section>

        <section id="asset-view-sec" class="tab-content hidden">
            <div class="bg-white p-6 rounded-lg border-2 border-black">
                <h2 class="text-center font-bold text-lg underline mb-6 uppercase">স্থায়ী সম্পদ রেজিস্টার</h2>
                <table class="govt-table">
                    <thead>
                        <tr>
                            <th>ক্র: নং</th>
                            <th>সম্পদের বিবরণ</th>
                            <th>শাখা/স্থান</th>
                            <th>তারিখ</th>
                            <th class="no-print">অ্যাকশন</th>
                        </tr>
                    </thead>
                    <tbody id="assetBody"></tbody>
                </table>
            </div>
        </section>

    </main>

    <script>
        const itemOptions = {
            "1": ["খুচরা যন্ত্রাংশ", "জেনারেটর মালামাল", "বোট/ইঞ্জিন মালামাল", "পাম্পের যন্ত্রাংশ", "জি আই ফিটিংস"],
            "2": ["ইলেক্ট্রিক মালামাল", "এসটিবি মালামাল", "গ্রাইডিং মালামাল", "টুলস মালামাল", "কম্পিউটার মালামাল", "লুব্রিকেন্ট"],
            "3": ["স্টেশনারী মালামাল", "নাট/বোল্ট", "টেস্ট হাউস সাপ্লাই", "পাইপ ফিটিংস", "মটর সাইকেল মালামাল"]
        };

        let db = JSON.parse(localStorage.getItem('bfidc_v14')) || [];

        function loadList() {
            const reg = document.getElementById('regType').value;
            const select = document.getElementById('itemName');
            select.innerHTML = '<option value="">মালামালের প্রকার</option>';
            if(itemOptions[reg]) {
                itemOptions[reg].forEach(i => select.innerHTML += `<option value="${i}">${i}</option>`);
            }
        }

        function saveData() {
            const editId = document.getElementById('editId').value;
            const entry = {
                id: editId ? parseInt(editId) : Date.now(),
                srn: document.getElementById('srnNo').value,
                date: document.getElementById('srnDate').value,
                vendor: document.getElementById('vendor').value,
                reg: document.getElementById('regType').value,
                name: document.getElementById('itemName').value,
                desc: document.getElementById('itemDesc').value,
                unit: document.getElementById('unit').value,
                qty: parseFloat(document.getElementById('qty').value) || 0,
                price: parseFloat(document.getElementById('price').value) || 0
            };

            if(!entry.srn || !entry.desc) return alert("তথ্য পূরণ করুন!");

            if(editId) {
                const idx = db.findIndex(x => x.id === entry.id);
                db[idx] = entry;
                alert("আপডেট হয়েছে!");
            } else {
                db.push(entry);
                alert("সেভ হয়েছে!");
            }

            localStorage.setItem('bfidc_v14', JSON.stringify(db));
            location.reload();
        }

        function renderSRN() {
            const container = document.getElementById('srnContainer');
            container.innerHTML = db.slice().reverse().map(d => `
                <div class="bg-white p-6 border-2 border-black shadow-md relative">
                    <div class="no-print absolute top-2 right-2 flex gap-2">
                        <button onclick="editItem(${d.id})" class="text-blue-600 p-2 border rounded"><i class="fa-solid fa-pen"></i></button>
                        <button onclick="deleteItem(${d.id})" class="text-red-600 p-2 border rounded"><i class="fa-solid fa-trash"></i></button>
                    </div>
                    <div class="text-center mb-4">
                        <h2 class="font-bold text-lg uppercase">বাংলাদেশ বনশিল্প উন্নয়ন কর্পোরেশন</h2>
                        <h3 class="font-bold underline">ভাণ্ডার গ্রহণ পত্র (SRN)</h3>
                    </div>
                    <div class="flex justify-between mb-2 font-bold text-sm">
                        <span>এস আর এন নং: ${d.srn}</span>
                        <span>তারিখ: ${d.date}</span>
                    </div>
                    <p class="mb-4 font-bold text-sm">কোথা হতে প্রাপ্ত: ${d.vendor}</p>
                    <table class="govt-table">
                        <thead>
                            <tr>
                                <th>ক্র: নং</th><th>মালামালের বিবরণ</th><th>একক</th><th>পরিমাণ</th><th>দর</th><th>মূল্য</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>১</td><td class="text-left font-bold">${d.name} - ${d.desc}</td><td>${d.unit}</td><td>${d.qty}</td><td>${d.price}</td><td>${(d.qty * d.price).toLocaleString()}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `).join('');
        }

        function renderLedger(filter = "") {
            const container = document.getElementById('ledgerContainer');
            const filtered = db.filter(d => d.name.toLowerCase().includes(filter.toLowerCase()));
            
            container.innerHTML = filtered.map(d => `
                <div class="ledger-blue-page mb-8">
                    <h3 class="text-center font-bold text-blue-900 underline mb-2">ভাণ্ডার মূল খতিয়ান (১ নং রেজিস্টার)</h3>
                    <p class="font-bold text-sm mb-2">মালামালের নাম: ${d.name}</p>
                    <table class="ledger-blue-table">
                        <thead>
                            <tr>
                                <th rowspan="2">তারিখ</th><th rowspan="2">বিবরণ</th><th colspan="3">প্রাপ্তি (Receipt)</th><th rowspan="2">স্থিতি (Balance)</th>
                            </tr>
                            <tr>
                                <th>SRN নং</th><th>পরিমাণ</th><th>দর</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>${d.date}</td><td class="text-left font-bold">${d.desc}</td><td>${d.srn}</td><td>${d.qty}</td><td>${d.price}</td><td class="${d.qty <= 5 ? 'red-alert' : 'font-bold'}">${d.qty}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `).join('');
        }

        function renderAsset() {
            const body = document.getElementById('assetBody');
            body.innerHTML = db.map((d, i) => `
                <tr>
                    <td>${i+1}</td><td class="text-left font-bold">${d.name} (${d.desc})</td><td>${d.vendor}</td><td>${d.date}</td>
                    <td class="no-print"><button onclick="deleteItem(${d.id})" class="text-red-500"><i class="fa-solid fa-trash"></i></button></td>
                </tr>
            `).join('');
        }

        function showSection(id) {
            document.querySelectorAll('.tab-content').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('tab-active'));
            document.getElementById(id + '-sec').classList.remove('hidden');
            document.getElementById('btn-' + id).classList.add('tab-active');
            if(id === 'srn-view') renderSRN();
            if(id === 'ledger-view') renderLedger();
            if(id === 'asset-view') renderAsset();
        }

        function editItem(id) {
            const d = db.find(x => x.id === id);
            document.getElementById('editId').value = d.id;
            document.getElementById('srnNo').value = d.srn;
            document.getElementById('srnDate').value = d.date;
            document.getElementById('vendor').value = d.vendor;
            document.getElementById('regType').value = d.reg;
            loadList();
            document.getElementById('itemName').value = d.name;
            document.getElementById('itemDesc').value = d.desc;
            document.getElementById('unit').value = d.unit;
            document.getElementById('qty').value = d.qty;
            document.getElementById('price').value = d.price;
            document.getElementById('saveBtn').innerText = "আপডেট করুন";
            showSection('entry');
        }

        function deleteItem(id) {
            if(confirm("আপনি কি নিশ্চিত?")) {
                db = db.filter(x => x.id !== id);
                localStorage.setItem('bfidc_v14', JSON.stringify(db));
                location.reload();
            }
        }

        function filterLedger() { renderLedger(document.getElementById('searchLedger').value); }
    </script>
</body>
</html>
