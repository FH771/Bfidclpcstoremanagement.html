<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFIDC | Store Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; background: #f0f2f5; }
        
        .watermark { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.08; z-index: -1; width: 300px; pointer-events: none; }

        /* Real SRN Book Style */
        .srn-paper { border: 1.5px solid #000; background: #fffde7; padding: 25px; box-shadow: 5px 5px 15px rgba(0,0,0,0.1); }
        .govt-table { width: 100%; border-collapse: collapse; border: 1.5px solid #000; margin-top: 10px; }
        .govt-table th, .govt-table td { border: 1px solid #000; padding: 5px; text-align: center; font-size: 12px; }
        .govt-table th { background: #eeeeee; }

        /* Real Blue Ledger Style from Image */
        .ledger-blue-book { background-color: #a2d2ff; border: 2px solid #0056b3; padding: 15px; overflow-x: auto; }
        .ledger-table { width: 100%; border-collapse: collapse; border: 1px solid #0056b3; background: #eefbff; }
        .ledger-table th { border: 1px solid #0056b3; padding: 4px; font-size: 10px; background: #8ecae6; }
        .ledger-table td { border: 1px solid #0056b3; padding: 6px; font-size: 11px; text-align: center; }

        .red-alert { background-color: #ff5252; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold; }
        .nav-active { background: #004d40; color: white; border-radius: 8px; }
        
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="pb-20">

    <img src="https://upload.wikimedia.org/wikipedia/en/thumb/0/02/Bangladesh_Forest_Industries_Development_Corporation_logo.png/220px-Bangladesh_Forest_Industries_Development_Corporation_logo.png" class="watermark" alt="Logo">

    <header class="bg-[#212121] text-white p-4 sticky top-0 z-50 no-print flex justify-between items-center">
        <div>
            <h1 class="text-md font-bold">বাংলাদেশ বনশিল্প উন্নয়ন কর্পোরেশন</h1>
            <p class="text-[10px] uppercase tracking-widest text-emerald-400">Smart Store Management</p>
        </div>
        <i class="fa-solid fa-warehouse text-2xl opacity-50"></i>
    </header>

    <main class="p-3 max-w-6xl mx-auto space-y-5">
        
        <div class="flex bg-white p-1 rounded-xl shadow-sm no-print overflow-x-auto text-xs font-bold">
            <button onclick="showPage('entry')" id="tab-entry" class="flex-1 py-3 nav-active">ডাটা এন্ট্রি</button>
            <button onclick="showPage('srn')" id="tab-srn" class="flex-1 py-3">SRN বই</button>
            <button onclick="showPage('ledger')" id="tab-ledger" class="flex-1 py-3">লেজার বুক</button>
            <button onclick="showPage('asset')" id="tab-asset" class="flex-1 py-3">স্থায়ী সম্পদ</button>
        </div>

        <section id="entry-page" class="bg-white p-5 rounded-2xl shadow-sm space-y-4 no-print border-t-4 border-emerald-700">
            <input type="hidden" id="edit-id">
            <div class="grid grid-cols-2 gap-3">
                <input type="text" id="srn-no" placeholder="এস আর এন নং" class="p-3 border rounded-xl outline-none focus:ring-2 ring-emerald-300">
                <input type="date" id="srn-date" class="p-3 border rounded-xl outline-none">
            </div>
            <input type="text" id="from-vendor" placeholder="কোথা হতে প্রাপ্ত (শাখা বা ব্যক্তির নাম)" class="w-full p-3 border rounded-xl outline-none">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <select id="reg-type" onchange="updateItemList()" class="p-3 border rounded-xl bg-gray-50 font-bold">
                    <option value="">রেজিস্টার নির্বাচন</option>
                    <option value="1">১ নং রেজিস্টার</option>
                    <option value="2">২ নং রেজিস্টার</option>
                    <option value="3">৩ নং রেজিস্টার</option>
                </select>
                <select id="item-cat" class="p-3 border rounded-xl"></select>
            </div>
            <textarea id="item-detail" placeholder="মালামালের বিস্তারিত বিবরণ ও সাইজ..." class="w-full p-3 border rounded-xl outline-none h-20"></textarea>
            
            <div class="grid grid-cols-3 gap-2">
                <input type="text" id="unit" placeholder="একক" class="p-3 border rounded-xl">
                <input type="number" id="qty" placeholder="পরিমাণ" class="p-3 border rounded-xl">
                <input type="number" id="price" placeholder="দর" class="p-3 border rounded-xl">
            </div>
            <button id="save-btn" onclick="handleSave()" class="w-full bg-[#004d40] text-white py-4 rounded-xl font-bold uppercase shadow-lg">তথ্য সংরক্ষণ করুন</button>
        </section>

        <section id="srn-page" class="hidden space-y-6">
            <div id="srn-container"></div>
        </section>

        <section id="ledger-page" class="hidden space-y-6">
            <div class="no-print mb-4">
                <input type="text" id="ledger-search" onkeyup="renderLedger()" placeholder="মালামালের নাম লিখে সার্চ..." class="w-full p-3 border-2 border-blue-400 rounded-xl outline-none">
            </div>
            <div id="ledger-container"></div>
        </section>

        <section id="asset-page" class="hidden bg-white p-5 rounded-lg border-2 border-black">
            <h2 class="text-center font-bold underline mb-4 uppercase">স্থায়ী সম্পদ রেজিস্টার</h2>
            <table class="govt-table">
                <thead>
                    <tr>
                        <th>ক্র: নং</th><th>সম্পদের বিবরণ</th><th>শাখা/স্থান</th><th>তারিখ</th><th class="no-print">অ্যাকশন</th>
                    </tr>
                </thead>
                <tbody id="asset-body"></tbody>
            </table>
        </section>

    </main>

    <script>
        const categories = {
            "1": ["খুচরা যন্ত্রাংশ", "জেনারেটর মালামাল", "বোট/ইঞ্জিন মালামাল", "পাম্পের যন্ত্রাংশ", "জি আই ফিটিংস"],
            "2": ["ইলেকট্রিক মালামাল", "এস টি বি মালামাল", "গ্রাইডিং মালামাল", "টুলস মালামাল", "ওয়েল্ডিং মালামাল", "কম্পিউটার মালামাল"],
            "3": ["স্টেশনারী মালামাল", "নাট/বোল্ট", "টেস্ট হাউস সাপ্লাই", "পাইপ এন্ড ফিটিংস", "মটর সাইকেল মালামাল"]
        };

        let db = JSON.parse(localStorage.getItem('bfidc_pro_v1')) || [];

        function updateItemList() {
            const reg = document.getElementById('reg-type').value;
            const select = document.getElementById('item-cat');
            select.innerHTML = '<option value="">মালামালের প্রকার</option>';
            if(categories[reg]) {
                categories[reg].forEach(item => select.innerHTML += `<option value="${item}">${item}</option>`);
            }
        }

        function handleSave() {
            const editId = document.getElementById('edit-id').value;
            const data = {
                id: editId ? parseInt(editId) : Date.now(),
                srn: document.getElementById('srn-no').value,
                date: document.getElementById('srn-date').value,
                vendor: document.getElementById('from-vendor').value,
                reg: document.getElementById('reg-type').value,
                cat: document.getElementById('item-cat').value,
                detail: document.getElementById('item-detail').value,
                unit: document.getElementById('unit').value,
                qty: parseFloat(document.getElementById('qty').value) || 0,
                price: parseFloat(document.getElementById('price').value) || 0
            };

            if(!data.srn || !data.detail) return alert("তথ্য পূরণ করুন!");

            if(editId) {
                const index = db.findIndex(x => x.id === data.id);
                db[index] = data;
            } else
